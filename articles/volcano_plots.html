<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Volcano Plots • MotrpacRatTraining6moWATData</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Volcano Plots">
<meta property="og:description" content="MotrpacRatTraining6moWATData">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MotrpacRatTraining6moWATData</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ADIPOCYTE_SIZE_STATS.html">Statistical analysis of adipocyte diameter</a>
    </li>
    <li>
      <a href="../articles/ANALYTES_STATS.html">Statistical analyses of plasma clinical analytes</a>
    </li>
    <li>
      <a href="../articles/MAIN_FGSEA.html">FGSEA of Omics Datasets</a>
    </li>
    <li>
      <a href="../articles/PHENO_WAT_STATS.html">Statistical analyses of post - pre training differences</a>
    </li>
    <li>
      <a href="../articles/PHOSPHO_KSEA.html">Kinase-Substrate Enrichment Analysis</a>
    </li>
    <li>
      <a href="../articles/PROT_MITOCARTA_FGSEA.html">Proteomics MitoCarta FGSEA</a>
    </li>
    <li>
      <a href="../articles/WAT_DA.html">Differential Analysis of Omics Datasets</a>
    </li>
    <li>
      <a href="../articles/WAT_WGCNA.html">WGCNA of Omics Datasets</a>
    </li>
    <li>
      <a href="../articles/WGCNA_MODULE_ORA.html">WGCNA Module ORA</a>
    </li>
    <li>
      <a href="../articles/FGSEA_heatmaps.html">Heatmaps of FGSEA Results</a>
    </li>
    <li>
      <a href="../articles/KSEA_heatmaps.html">Heatmaps of Kinase-Substrate Enrichment Analysis Results</a>
    </li>
    <li>
      <a href="../articles/METAB_TAG_heatmap.html">Heatmap of total triacylglycerol concentrations</a>
    </li>
    <li>
      <a href="../articles/MitoCarta_FGSEA_heatmaps.html">Plots of MitoCarta 3.0 FGSEA Results</a>
    </li>
    <li>
      <a href="../articles/WGCNA_METAB_module_heatmaps.html">Heatmaps of Metabolites Grouped by WGCNA Module</a>
    </li>
    <li>
      <a href="../articles/WGCNA_correlation_heatmaps.html">Heatmaps of WGCNA Module Correlations</a>
    </li>
    <li>
      <a href="../articles/WGCNA_eigenfeature_plots.html">Plots of WGCNA eigenfeatures for each -ome</a>
    </li>
    <li>
      <a href="../articles/WGCNA_module_ORA.html">Plots of WGCNA Module Over-Representation Analysis Results</a>
    </li>
    <li>
      <a href="../articles/limma_diagnostics.html">LIMMA Diagnostic Plots</a>
    </li>
    <li>
      <a href="../articles/lipid_regulatory_proteins_heatmap.html">Heatmap of lipid regulatory proteins</a>
    </li>
    <li>
      <a href="../articles/plot_FGSEA_male_vs_female_summary.html">Plots of Top FGSEA Terms from Male vs. Female Comparisons</a>
    </li>
    <li>
      <a href="../articles/plot_Hk2.html">Plot of hexokinase 2 (Hk2) protein log2 relative abundance</a>
    </li>
    <li>
      <a href="../articles/plot_TAG_chain_length_vs_logFC.html">Plots of TAG chain length or number of double bonds vs. log2 fold-change</a>
    </li>
    <li>
      <a href="../articles/plot_UpSet.html">Differential analysis UpSet Plots</a>
    </li>
    <li>
      <a href="../articles/plot_adipocyte_size_distribution.html">Plots of Adipocyte Size Distributions</a>
    </li>
    <li>
      <a href="../articles/plot_analytes.html">Plots of plasma clinical analytes</a>
    </li>
    <li>
      <a href="../articles/plot_mito_reads_and_cardiolipin.html">Plots of % mitochondrial reads and cardiolipin</a>
    </li>
    <li>
      <a href="../articles/plot_mtDNA.html">Plot of Mitochondrial DNA (mtDNA)</a>
    </li>
    <li>
      <a href="../articles/plot_pct_fat_vs_leptin.html">Plot of Change in % Body Fat vs. Plasma Leptin</a>
    </li>
    <li>
      <a href="../articles/plot_pre_post.html">Plots of pre and post training values</a>
    </li>
    <li>
      <a href="../articles/plot_proteins.html">Plots of log2 relative abundances of various proteins</a>
    </li>
    <li>
      <a href="../articles/volcano_plots.html">Volcano Plots</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/MoTrPAC/MotrpacRatTraining6moWATData/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Volcano Plots</h1>
                        <h4 data-toc-skip class="author">Tyler
Sagendorf</h4>
            
            <h4 data-toc-skip class="date">05 March, 2024</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/MoTrPAC/MotrpacRatTraining6moWATData/blob/HEAD/vignettes/articles/volcano_plots.Rmd" class="external-link"><code>vignettes/articles/volcano_plots.Rmd</code></a></small>
      <div class="hidden name"><code>volcano_plots.Rmd</code></div>

    </div>

    
    
<p>This article contains generates volcano plots (Fig 2A; Extended Data
Fig. 2A–D). By default, the chunks are not set to evaluate, since the
volcano plots exceed the maximum dimensions. Run each chunk in this
article individually (do not knit) to generate and save the volcano
plots.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://motrpac.github.io/MotrpacRatTraining6moWATData/" class="external-link">MotrpacRatTraining6moWATData</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://motrpac.github.io/MotrpacRatTraining6moWAT/" class="external-link">MotrpacRatTraining6moWAT</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.stefanom.io/latex2exp/" class="external-link">latex2exp</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggrepel.slowkow.com/" class="external-link">ggrepel</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://scales.r-lib.org" class="external-link">scales</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># List of all differential analysis results</span></span>
<span><span class="va">all_DA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>TRNSCRPT <span class="op">=</span> <span class="va">TRNSCRPT_DA</span>,</span>
<span>               PROT     <span class="op">=</span> <span class="va">PROT_DA</span>,</span>
<span>               PHOSPHO  <span class="op">=</span> <span class="va">PHOSPHO_DA</span>,</span>
<span>               METAB    <span class="op">=</span> <span class="va">METAB_DA</span><span class="op">)</span></span>
<span></span>
<span><span class="va">all_DA</span><span class="op">$</span><span class="va">PHOSPHO</span><span class="op">$</span><span class="va">MvF_SED</span> <span class="op">&lt;-</span> <span class="va">all_DA</span><span class="op">$</span><span class="va">PHOSPHO</span><span class="op">$</span><span class="va">MvF_SED</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>site <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">gene_symbol</span>, <span class="st">"-"</span>, <span class="va">site</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Updates required for volcano plots</span></span>
<span><span class="va">update_dea_res</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">feature</span>, <span class="va">contrast</span>, <span class="va">P.Value</span>, <span class="va">adj.P.Val</span>, <span class="va">logFC</span>, <span class="va">feature</span>,</span>
<span>                  <span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">any_of</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"site"</span>, <span class="st">"gene_symbol"</span>,</span>
<span>                           <span class="st">"entrez_gene"</span>, <span class="st">"name_in_figures"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>log10_pval <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">adj.P.Val</span><span class="op">)</span>,</span>
<span>           sign_logFC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sign.html" class="external-link">sign</a></span><span class="op">(</span><span class="va">logFC</span><span class="op">)</span><span class="op">)</span>,</span>
<span>           sign_logFC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">adj.P.Val</span> <span class="op">&lt;</span> <span class="fl">0.05</span>, <span class="va">sign_logFC</span>, <span class="st">"NS"</span><span class="op">)</span>,</span>
<span>           sign_logFC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">sign_logFC</span>,</span>
<span>                               levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"-1"</span>, <span class="st">"1"</span>, <span class="st">"NS"</span><span class="op">)</span>,</span>
<span>                               labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dn"</span>, <span class="st">"up"</span>, <span class="st">"NS"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">contrast</span>, <span class="va">sign_logFC</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Count number of features by sign(logFC)</span></span>
<span>  <span class="va">x_sub</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">contrast</span>, <span class="va">sign_logFC</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">sign_logFC</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">contrast</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">label</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">x_sub</span>, by <span class="op">=</span> <span class="st">"contrast"</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Function for label nudge</span></span>
<span><span class="va">nudge_volcano_labels</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">offset</span> <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">x</span></span>
<span>  <span class="va">len_y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span>  <span class="va">increment</span> <span class="op">&lt;-</span> <span class="va">offset</span> <span class="op">/</span> <span class="fl">8</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">len_y</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="va">len_y</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw">while</span> <span class="op">(</span><span class="va">y</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="va">y</span><span class="op">[</span><span class="va">i</span> <span class="op">-</span> <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">offset</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">y</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">y</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="va">increment</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">y</span> <span class="op">-</span> <span class="va">x</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Volcano plots for combined MvF SED results --------------------</span></span>
<span><span class="va">MvF_volcano</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span>.x <span class="op">=</span> <span class="va">all_DA</span>, <span class="va">pluck</span>, <span class="st">"MvF_SED"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="op">~</span> <span class="fu">update_dea_res</span><span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"entrez_gene"</span><span class="op">)</span>, <span class="va">as.character</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/enframe.html" class="external-link">enframe</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"ome"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>ome <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">ome</span>, <span class="st">"\n"</span>, <span class="va">label</span><span class="op">)</span>,</span>
<span>         ome <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">ome</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">ome</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://motrpac.github.io/MotrpacRatTraining6moWAT/reference/plot_volcano.html" class="external-link">plot_volcano</a></span><span class="op">(</span>colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#ff6eff"</span>, <span class="st">"#5555ff"</span>, <span class="st">"grey"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">ome</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">30</span><span class="op">)</span>,</span>
<span>                     sec.axis <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/sec_axis.html" class="external-link">sec_axis</a></span><span class="op">(</span>trans <span class="op">=</span> <span class="op">~</span> <span class="fl">10</span> <span class="op">^</span> <span class="op">(</span><span class="op">-</span><span class="va">.</span><span class="op">)</span>,</span>
<span>                                         breaks <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>,</span>
<span>                     expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html" class="external-link">TeX</a></span><span class="op">(</span><span class="st">"$log_2$(fold-change): Male - Female"</span><span class="op">)</span>,</span>
<span>       y <span class="op">=</span> <span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html" class="external-link">TeX</a></span><span class="op">(</span><span class="st">"$-log_{10}$(BH-adjusted p-value)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">0</span>, <span class="st">"pt"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add feature labels</span></span>
<span><span class="va">point_labels</span> <span class="op">&lt;-</span> <span class="va">MvF_volcano</span><span class="op">$</span><span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">adj.P.Val</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">ome</span>, <span class="va">contrast</span>, <span class="va">sign_logFC</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_min</a></span><span class="op">(</span>order_by <span class="op">=</span> <span class="va">adj.P.Val</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">MvF_volcano</span><span class="op">$</span><span class="va">data</span>, </span>
<span>               <span class="va">adj.P.Val</span> <span class="op">&lt;</span> <span class="fl">0.05</span>, </span>
<span>               <span class="va">gene_symbol</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Adipoq"</span>, <span class="st">"Slc2a4"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>SiteID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"^PHOSPHO"</span>, <span class="va">ome</span><span class="op">)</span>,</span>
<span>                         <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">gene_symbol</span>, <span class="st">"-"</span>, <span class="va">site</span><span class="op">)</span>,</span>
<span>                         <span class="cn">NA</span><span class="op">)</span>,</span>
<span>         feature_label <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>           <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">site</span><span class="op">)</span> <span class="op">~</span> <span class="va">site</span>,</span>
<span>           <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">gene_symbol</span><span class="op">)</span> <span class="op">~</span> <span class="va">gene_symbol</span>,</span>
<span>           <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">entrez_gene</span><span class="op">)</span> <span class="op">~</span> <span class="va">entrez_gene</span>,</span>
<span>           <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">name_in_figures</span><span class="op">)</span> <span class="op">~</span> <span class="va">name_in_figures</span>,</span>
<span>           <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">feature</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Remove certain features from the plot</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="va">feature_label</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AABR07039356.2"</span>, <span class="st">"Prickle2"</span><span class="op">)</span> <span class="op">&amp;</span> </span>
<span>             <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"^TRNSCRPT"</span>, <span class="va">ome</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         <span class="op">!</span><span class="op">(</span><span class="va">feature_label</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Stn1"</span>, <span class="st">"Ccar2"</span><span class="op">)</span> <span class="op">&amp;</span> </span>
<span>             <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"^PROT"</span>, <span class="va">ome</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ome</span>, <span class="va">contrast</span>, <span class="va">sign_logFC</span>, <span class="va">feature</span>, <span class="va">feature_label</span>, </span>
<span>                <span class="va">adj.P.Val</span>, <span class="va">P.Value</span>, <span class="va">logFC</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>feature_label <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>    <span class="va">feature_label</span> <span class="op">==</span> <span class="st">"TG 58:34*"</span> <span class="op">~</span> <span class="st">"TG 58:4"</span>,</span>
<span>    <span class="va">feature_label</span> <span class="op">==</span> <span class="st">"PE P-38:5 or PE O-38:6"</span> <span class="op">~</span> <span class="st">"PE O-38:6"</span>,</span>
<span>    <span class="va">feature_label</span> <span class="op">==</span> <span class="st">"Hydroxydodecanoic acid"</span> <span class="op">~</span> <span class="st">"FA 12:0-OH"</span>,</span>
<span>    <span class="va">feature_label</span> <span class="op">==</span> <span class="st">"Hydroxydecanoic acid"</span> <span class="op">~</span> <span class="st">"FA 10:0-OH"</span>,</span>
<span>    <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">feature_label</span><span class="op">)</span>,</span>
<span>    log10_pval <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">adj.P.Val</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">contrast</span>, <span class="va">log10_pval</span>, <span class="op">-</span><span class="va">P.Value</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">contrast</span>, <span class="va">sign_logFC</span>, <span class="va">ome</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>nudge_y <span class="op">=</span> <span class="fu">nudge_volcano_labels</span><span class="op">(</span>x <span class="op">=</span> <span class="va">log10_pval</span>, offset <span class="op">=</span> <span class="fl">2.2</span><span class="op">)</span>,</span>
<span>         nudge_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sign.html" class="external-link">sign</a></span><span class="op">(</span><span class="va">logFC</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1.05</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">logFC</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">+</span> </span>
<span>           <span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sign.html" class="external-link">sign</a></span><span class="op">(</span><span class="va">logFC</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MvF_volcano</span> <span class="op">&lt;-</span> <span class="va">MvF_volcano</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggrepel.slowkow.com/reference/geom_text_repel.html" class="external-link">geom_label_repel</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">logFC</span>, y <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">adj.P.Val</span><span class="op">)</span>, </span>
<span>                       label <span class="op">=</span> <span class="va">feature_label</span><span class="op">)</span>,</span>
<span>                   data <span class="op">=</span> <span class="va">point_labels</span>,</span>
<span>                   force <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                   size <span class="op">=</span> <span class="fl">5</span> <span class="op">/</span> <span class="va">.pt</span>,</span>
<span>                   fill <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html" class="external-link">alpha</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="fl">0.7</span><span class="op">)</span>,</span>
<span>                   label.padding <span class="op">=</span> <span class="fl">0.12</span>,</span>
<span>                   label.size <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>                   segment.size <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>                   box.padding <span class="op">=</span> <span class="fl">0.15</span>,</span>
<span>                   min.segment.length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0</span>, <span class="st">"pt"</span><span class="op">)</span>,</span>
<span>                   nudge_x <span class="op">=</span> <span class="va">point_labels</span><span class="op">$</span><span class="va">nudge_x</span>,</span>
<span>                   nudge_y <span class="op">=</span> <span class="va">point_labels</span><span class="op">$</span><span class="va">nudge_y</span>,</span>
<span>                   max.overlaps <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span></span>
<span></span>
<span><span class="va">MvF_volcano</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">".."</span>, <span class="st">".."</span>, <span class="st">"plots"</span>, <span class="st">"volcano_MvF_SED_all_omes.pdf"</span><span class="op">)</span>,</span>
<span>       <span class="va">MvF_volcano</span>, height <span class="op">=</span> <span class="fl">2.3</span>, width <span class="op">=</span> <span class="fl">6.5</span>, units <span class="op">=</span> <span class="st">"in"</span>,</span>
<span>       dpi <span class="op">=</span> <span class="fl">400</span>, bg <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create volcano plots for each ome</span></span>
<span><span class="va">omes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TRNSCRPT"</span>, <span class="st">"PROT"</span>, <span class="st">"PHOSPHO"</span>, <span class="st">"METAB"</span><span class="op">)</span></span>
<span><span class="va">features</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Transcripts"</span>, <span class="st">"Proteins"</span>, <span class="st">"Phosphosites"</span>, <span class="st">"Metabolites"</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">omes</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Get DEA results</span></span>
<span>  <span class="va">features</span> <span class="op">&lt;-</span> <span class="va">features</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="va">ome</span> <span class="op">&lt;-</span> <span class="va">omes</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="va">ome</span><span class="op">)</span></span>
<span>  <span class="va">dea_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">all_DA</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, .f <span class="op">=</span> <span class="va">update_dea_res</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">## Trained vs SED ------------------------------------------------------------</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Timewise"</span><span class="op">)</span></span>
<span>  <span class="va">train_res</span> <span class="op">&lt;-</span> <span class="va">dea_res</span><span class="op">$</span><span class="va">trained_vs_SED</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>contrast <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span></span>
<span>      <span class="va">contrast</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">contrast</span><span class="op">)</span>,</span>
<span>      labels <span class="op">=</span> <span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html" class="external-link">TeX</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"(%dW - SED)$_{%s}$"</span>,</span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">^</span> <span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>, times <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"F"</span>, <span class="st">"M"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/switch.html" class="external-link">switch</a></span><span class="op">(</span><span class="va">ome</span>,</span>
<span>         TRNSCRPT <span class="op">=</span> <span class="op">{</span></span>
<span>           <span class="va">features_to_label</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>             feature_label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>               <span class="co"># Female</span></span>
<span>               <span class="co">## 1W - SED</span></span>
<span>               <span class="st">"Ace"</span>, <span class="st">"Smpd3"</span>, <span class="st">"Aamdc"</span>, <span class="st">"Camk2b"</span>, <span class="st">"Acly"</span>, <span class="st">"Fasn"</span>, <span class="st">"Grb14"</span>, </span>
<span>               <span class="st">"Olah"</span>, <span class="st">"Hmgcs2"</span>, <span class="st">"Ca12"</span>,</span>
<span>               <span class="co">## 2W - SED</span></span>
<span>               <span class="st">"Fasn"</span>, <span class="st">"Acly"</span>, <span class="st">"Grb14"</span>, <span class="st">"Olah"</span>, <span class="st">"Hmgcs2"</span>, <span class="st">"Ca12"</span>,</span>
<span>               <span class="co">## 4W - SED</span></span>
<span>               <span class="st">"Fasn"</span>, <span class="st">"Aqp3"</span>, <span class="st">"Crabp2"</span>, <span class="st">"Aacs"</span>, <span class="st">"Acly"</span>, <span class="st">"Grb14"</span>, <span class="st">"Olah"</span>, </span>
<span>               <span class="st">"Hmgcs2"</span>, <span class="st">"Ca12"</span>,</span>
<span>               <span class="co">## 8W - SED</span></span>
<span>               <span class="st">"Crabp2"</span>, <span class="st">"Fads2"</span>, <span class="st">"Acaca"</span>, <span class="st">"Fasn"</span>, <span class="st">"Acaca"</span>, <span class="st">"Endou"</span>, <span class="st">"Orm1"</span>, </span>
<span>               <span class="st">"Acly"</span>, <span class="st">"Grb14"</span>, <span class="st">"Olah"</span>, <span class="st">"Hmgcs2"</span>, <span class="st">"Ca12"</span>,</span>
<span>               </span>
<span>               <span class="co"># Male</span></span>
<span>               <span class="co">## 1W - SED</span></span>
<span>               <span class="st">"Acot1"</span>, <span class="st">"Adcy3"</span>, <span class="st">"Hif1a"</span>, <span class="st">"Steap4"</span>, <span class="st">"Fasn"</span>, <span class="st">"Acly"</span>, <span class="st">"Grb14"</span>, </span>
<span>               <span class="st">"Olah"</span>, <span class="st">"Hmgcs2"</span>, <span class="st">"Ca12"</span>,</span>
<span>               <span class="co">## 2W - SED</span></span>
<span>               <span class="st">"Kdr"</span>, <span class="st">"Elovl6"</span>, <span class="st">"Pdgfrb"</span>, <span class="st">"Hif1a"</span>, <span class="st">"Fasn"</span>, <span class="st">"Acly"</span>, <span class="st">"Grb14"</span>, </span>
<span>               <span class="st">"Olah"</span>, <span class="st">"Hmgcs2"</span>, <span class="st">"Ca12"</span>,</span>
<span>               <span class="co">## 4W - SED</span></span>
<span>               <span class="st">"Kcnj13"</span>, <span class="st">"Ctsz"</span>, <span class="st">"Nkap"</span>, <span class="st">"Fasn"</span>, <span class="st">"Acly"</span>, <span class="st">"Grb14"</span>, <span class="st">"Olah"</span>, </span>
<span>               <span class="st">"Hmgcs2"</span>, <span class="st">"Ca12"</span>,</span>
<span>               <span class="co">## 8W - SED</span></span>
<span>               <span class="st">"RT1-A1"</span>, <span class="st">"Ctsz"</span>, <span class="st">"Atp11a"</span>, <span class="st">"Lpcat1"</span>, <span class="st">"Fasn"</span>, <span class="st">"Acly"</span>, <span class="st">"Grb14"</span>, </span>
<span>               <span class="st">"Olah"</span>, <span class="st">"Hmgcs2"</span>, <span class="st">"Ca12"</span><span class="op">)</span>, </span>
<span>             contrast <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">train_res</span><span class="op">$</span><span class="va">contrast</span><span class="op">)</span>, </span>
<span>                            <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">6</span>, <span class="fl">9</span>, <span class="fl">12</span>, </span>
<span>                              <span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">9</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>contrast <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">contrast</span>, </span>
<span>                                      levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">train_res</span><span class="op">$</span><span class="va">contrast</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>         <span class="op">}</span>,</span>
<span>         PROT <span class="op">=</span> <span class="op">{</span></span>
<span>           <span class="va">features_to_label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>             feature_label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>               <span class="co"># Female</span></span>
<span>               <span class="co">## 1W - SED</span></span>
<span>               <span class="st">"Camk2b"</span>, <span class="st">"Ace"</span>, <span class="st">"Maip"</span>, <span class="st">"Atp6v0d1"</span>, <span class="st">"Immt"</span>, <span class="st">"Slc25a11"</span>, </span>
<span>               <span class="st">"Slc25a3"</span>, <span class="st">"Slc25a15"</span>, <span class="st">"Tmed2"</span>, <span class="st">"Sec61a1"</span>, <span class="st">"Lrpprc"</span>, <span class="st">"Slc25a15"</span>, </span>
<span>               <span class="st">"Grb14"</span>, <span class="st">"Orm1"</span>,</span>
<span>               <span class="co">## 2W - SED</span></span>
<span>               <span class="st">"Camk2b"</span>, <span class="st">"Ace"</span>, <span class="st">"Lrg1"</span>, <span class="st">"Maip"</span>, <span class="st">"Atp6v0d1"</span>, <span class="st">"Immt"</span>, <span class="st">"Slc25a11"</span>, </span>
<span>               <span class="st">"Slc25a3"</span>, <span class="st">"Slc25a15"</span>, <span class="st">"Tmed2"</span>, <span class="st">"Sec61a1"</span>, <span class="st">"Lrpprc"</span>, <span class="st">"Slc25a15"</span>, </span>
<span>               <span class="st">"Grb14"</span>, <span class="st">"Orm1"</span>,</span>
<span>               <span class="co">## 4W - SED</span></span>
<span>               <span class="st">"Lifr"</span>, <span class="st">"Orm1"</span>, <span class="st">"Ltbp2"</span>, <span class="st">"Il1r2"</span>, <span class="st">"Maip"</span>, <span class="st">"Atp6v0d1"</span>, <span class="st">"Immt"</span>, </span>
<span>               <span class="st">"Slc25a11"</span>, <span class="st">"Slc25a3"</span>, <span class="st">"Slc25a15"</span>, <span class="st">"Tmed2"</span>, <span class="st">"Sec61a1"</span>, <span class="st">"Lrpprc"</span>, </span>
<span>               <span class="st">"Slc25a15"</span>, <span class="st">"Grb14"</span>,</span>
<span>               <span class="co">## 8W - SED</span></span>
<span>               <span class="st">"Lifr"</span>, <span class="st">"Endou"</span>, <span class="st">"Arg1"</span>, <span class="st">"Orm1"</span>, <span class="st">"Tgfbr3"</span>, <span class="st">"Hspa1b"</span>, <span class="st">"Maip"</span>, </span>
<span>               <span class="st">"Atp6v0d1"</span>, <span class="st">"Immt"</span>, <span class="st">"Slc25a11"</span>, <span class="st">"Slc25a3"</span>, <span class="st">"Slc25a15"</span>, <span class="st">"Tmed2"</span>, </span>
<span>               <span class="st">"Sec61a1"</span>, <span class="st">"Lrpprc"</span>, <span class="st">"Slc25a15"</span>, <span class="st">"Grb14"</span>,</span>
<span>               </span>
<span>               <span class="co"># Male</span></span>
<span>               <span class="co">## 1W - SED</span></span>
<span>               <span class="st">"Tie1"</span>, <span class="st">"Hdac4"</span>, <span class="st">"Fth1"</span>, <span class="st">"Maip"</span>, <span class="st">"Immt"</span>, <span class="st">"Slc25a11"</span>, <span class="st">"Slc25a3"</span>, </span>
<span>               <span class="st">"Slc25a15"</span>, <span class="st">"Lrpprc"</span>, <span class="st">"Slc25a15"</span>, <span class="st">"Grb14"</span>, <span class="st">"Orm1"</span>,</span>
<span>               <span class="co">## 2W - SED</span></span>
<span>               <span class="st">"Fth1"</span>, <span class="st">"Cuta"</span>, <span class="st">"Hsd17b12"</span>, <span class="st">"Glyctk"</span>, <span class="st">"Hdac4"</span>, <span class="st">"Maip"</span>, <span class="st">"Immt"</span>, </span>
<span>               <span class="st">"Slc25a11"</span>, <span class="st">"Slc25a3"</span>, <span class="st">"Slc25a15"</span>, <span class="st">"Lrpprc"</span>, <span class="st">"Slc25a15"</span>, <span class="st">"Grb14"</span>,</span>
<span>               <span class="st">"Orm1"</span>,</span>
<span>               <span class="co">## 4W - SED</span></span>
<span>               <span class="st">"Fth1"</span>, <span class="st">"Hebp2"</span>, <span class="st">"Crabp1"</span>, <span class="st">"Slc27a1"</span>, <span class="st">"Maoa"</span>, <span class="st">"Rbp1"</span>, <span class="st">"Hsd17b12"</span>, </span>
<span>               <span class="st">"Akr1d1"</span>, <span class="st">"Nos1"</span>, <span class="st">"Maip"</span>, <span class="st">"Immt"</span>, <span class="st">"Slc25a11"</span>, <span class="st">"Slc25a3"</span>, </span>
<span>               <span class="st">"Slc25a15"</span>, <span class="st">"Lrpprc"</span>, <span class="st">"Slc25a15"</span>, <span class="st">"Grb14"</span>, <span class="st">"Orm1"</span>,</span>
<span>               <span class="co">## 8W - SED</span></span>
<span>               <span class="st">"Hacl1"</span>, <span class="st">"Hsph1"</span>, <span class="st">"Hspa1b"</span>, <span class="st">"Lep"</span>, <span class="st">"Sparc"</span>, <span class="st">"Maip"</span>, <span class="st">"Immt"</span>, </span>
<span>               <span class="st">"Slc25a11"</span>, <span class="st">"Slc25a3"</span>, <span class="st">"Slc25a15"</span>, <span class="st">"Lrpprc"</span>, <span class="st">"Slc25a15"</span>, </span>
<span>               <span class="st">"Grb14"</span>, <span class="st">"Orm1"</span><span class="op">)</span>,</span>
<span>             contrast <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">train_res</span><span class="op">$</span><span class="va">contrast</span><span class="op">)</span>, </span>
<span>                            <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">14</span>, <span class="fl">15</span>, <span class="fl">15</span>, <span class="fl">17</span>,</span>
<span>                              <span class="fl">12</span>, <span class="fl">14</span>, <span class="fl">18</span>, <span class="fl">14</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>contrast <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">contrast</span>, </span>
<span>                                      levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">train_res</span><span class="op">$</span><span class="va">contrast</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>         <span class="op">}</span>,</span>
<span>         METAB <span class="op">=</span> <span class="op">{</span></span>
<span>           <span class="va">metab_features</span> <span class="op">&lt;-</span> <span class="va">train_res</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">adj.P.Val</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>             <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">name_in_figures</span>, <span class="va">P.Value</span>, <span class="va">adj.P.Val</span>, <span class="va">contrast</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">name_in_figures</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">train_res</span><span class="op">$</span><span class="va">contrast</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="va">contrast</span><span class="op">)</span> <span class="op">|</span></span>
<span>                      <span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">train_res</span><span class="op">$</span><span class="va">contrast</span><span class="op">)</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="va">contrast</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">name_in_figures</span>, <span class="va">contrast</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_min</a></span><span class="op">(</span><span class="va">P.Value</span>, n <span class="op">=</span> <span class="fl">1</span>, with_ties <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sex_female <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"F"</span>, <span class="va">contrast</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">name_in_figures</span>, <span class="va">sex_female</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">name_in_figures</span>, <span class="va">sex_female</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>mean_padj <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">adj.P.Val</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">sex_female</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_max</a></span><span class="op">(</span><span class="va">mean_padj</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">name_in_figures</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>             <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span></span>
<span>           </span>
<span>           <span class="va">features_to_label</span> <span class="op">&lt;-</span> <span class="va">train_res</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">adj.P.Val</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">name_in_figures</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="va">metab_features</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>             <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span>feature_label <span class="op">=</span> <span class="va">name_in_figures</span>, <span class="va">contrast</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>feature_label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">" or P[EC] "</span>, <span class="st">"\\|\\|"</span>, <span class="va">feature_label</span><span class="op">)</span><span class="op">)</span></span>
<span>         <span class="op">}</span>,</span>
<span>         PHOSPHO <span class="op">=</span> <span class="op">{</span></span>
<span>           <span class="va">features_to_label</span> <span class="op">&lt;-</span> <span class="va">train_res</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>feature_label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">gene_symbol</span>, <span class="st">"-"</span>, <span class="va">site</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">feature_label</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> </span>
<span>                      <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Pde4a-S140"</span>, <span class="st">"Pde4b-S118"</span>, <span class="st">"Ankrd2-S317"</span>, </span>
<span>                        <span class="st">"Lrrfip1-S257"</span>, <span class="st">"Lrrfip1-S232"</span>, <span class="st">"Lrrfip1-S85"</span>, </span>
<span>                        <span class="st">"Camk2b-T398"</span>, <span class="st">"Htt-S621"</span>, <span class="st">"Klc1-S521;S524"</span>, </span>
<span>                        <span class="st">"Uhrf1bp1l-S418"</span>, <span class="st">"Bnip3-T66"</span>, <span class="st">"Ulf1-S458"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">adj.P.Val</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>             <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">feature</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">contrast</span>, <span class="va">feature_label</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_min</a></span><span class="op">(</span>order_by <span class="op">=</span> <span class="va">P.Value</span>, n <span class="op">=</span> <span class="fl">1</span>, with_ties <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>             <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">feature_label</span>, <span class="va">contrast</span><span class="op">)</span></span>
<span>         <span class="op">}</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">train_labels</span> <span class="op">&lt;-</span> <span class="va">train_res</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">adj.P.Val</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html" class="external-link">add_column</a></span><span class="op">(</span>site <span class="op">=</span> <span class="cn">NA</span>, </span>
<span>               name_in_figures <span class="op">=</span> <span class="cn">NA</span>, </span>
<span>               gene_symbol <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>               .name_repair <span class="op">=</span> <span class="st">"unique"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>name_in_figures <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">" or P[EC] "</span>, <span class="st">"\\|\\|"</span>, <span class="va">name_in_figures</span><span class="op">)</span>,</span>
<span>           feature_label <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>             <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">site</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">gene_symbol</span>, <span class="va">site</span>, sep <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span>,</span>
<span>             <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">name_in_figures</span><span class="op">)</span> <span class="op">~</span> <span class="va">name_in_figures</span>,</span>
<span>             <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">gene_symbol</span></span>
<span>           <span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">contrast</span>, <span class="va">feature_label</span>, <span class="va">adj.P.Val</span>, </span>
<span>                  <span class="va">log10_pval</span>, <span class="va">P.Value</span>, <span class="va">logFC</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">inner_join</a></span><span class="op">(</span><span class="va">features_to_label</span>, </span>
<span>               by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"contrast"</span>, <span class="st">"feature_label"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">contrast</span>, <span class="va">feature_label</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_min</a></span><span class="op">(</span>order_by <span class="op">=</span> <span class="va">adj.P.Val</span>, n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">contrast</span>, <span class="va">log10_pval</span>, <span class="op">-</span><span class="va">P.Value</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">contrast</span>, <span class="fu"><a href="https://rdrr.io/r/base/sign.html" class="external-link">sign</a></span><span class="op">(</span><span class="va">logFC</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>nudge_y <span class="op">=</span> <span class="fu">nudge_volcano_labels</span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">log10_pval</span>,</span>
<span>      offset <span class="op">=</span> <span class="fl">0.4</span> <span class="op">+</span> <span class="fl">0.1</span> <span class="op">*</span> <span class="op">(</span><span class="va">ome</span> <span class="op">==</span> <span class="st">"TRNSCRPT"</span><span class="op">)</span> <span class="op">-</span> <span class="fl">0.05</span> <span class="op">*</span> <span class="op">(</span><span class="va">ome</span> <span class="op">==</span> <span class="st">"PHOSPHO"</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">-</span> <span class="fl">0.25</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    nudge_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sign.html" class="external-link">sign</a></span><span class="op">(</span><span class="va">logFC</span><span class="op">)</span> <span class="op">*</span> </span>
<span>      <span class="fu"><a href="https://scales.r-lib.org/reference/rescale.html" class="external-link">rescale</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/rank.html" class="external-link">rank</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">logFC</span><span class="op">)</span><span class="op">)</span>,</span>
<span>              to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.6</span>, <span class="fl">1.5</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">logFC</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">contrast</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>nudge_x <span class="op">=</span> <span class="va">nudge_x</span> <span class="op">-</span> <span class="op">(</span><span class="va">ome</span> <span class="op">==</span> <span class="st">"METAB"</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">logFC</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">## Volcano plots</span></span>
<span>  <span class="va">v_train</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://motrpac.github.io/MotrpacRatTraining6moWAT/reference/plot_volcano.html" class="external-link">plot_volcano</a></span><span class="op">(</span><span class="va">train_res</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">contrast</span>, nrow <span class="op">=</span> <span class="fl">1</span>,</span>
<span>               scales <span class="op">=</span> <span class="st">"free_x"</span>,</span>
<span>               labeller <span class="op">=</span> <span class="va">label_parsed</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html" class="external-link">TeX</a></span><span class="op">(</span><span class="st">"$log_2$(fold-change)"</span><span class="op">)</span>,</span>
<span>         y <span class="op">=</span> <span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html" class="external-link">TeX</a></span><span class="op">(</span><span class="st">"$-log_{10}$(BH-adjusted p-value)"</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Add annotations for number of up, down, or NS features</span></span>
<span>  <span class="va">v_train</span> <span class="op">&lt;-</span> <span class="va">v_train</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_label</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="va">train_res</span>, <span class="va">contrast</span>, <span class="va">label</span><span class="op">)</span>,</span>
<span>               <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">label</span>, x <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, y <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span>,</span>
<span>               size <span class="op">=</span> <span class="fl">5</span> <span class="op">/</span> <span class="va">.pt</span>, </span>
<span>               label.size <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>               label.padding <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">4</span>, <span class="st">"pt"</span><span class="op">)</span>,</span>
<span>               fill <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html" class="external-link">alpha</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>               <span class="co"># label.r = unit(1.5, "pt"),</span></span>
<span>               hjust <span class="op">=</span> <span class="fl">0.05</span>, vjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>clip <span class="op">=</span> <span class="st">"off"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Set axis limits</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">ome</span> <span class="op">!=</span> <span class="st">"TRNSCRPT"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">v_train</span> <span class="op">&lt;-</span> <span class="va">v_train</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">8</span>, <span class="fl">8</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>                         expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                                            add <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">ome</span> <span class="op">==</span> <span class="st">"METAB"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">v_train</span> <span class="op">&lt;-</span> <span class="va">v_train</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>                         expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fl">1e-2</span><span class="op">)</span>,</span>
<span>                         sec.axis <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/sec_axis.html" class="external-link">sec_axis</a></span><span class="op">(</span>trans <span class="op">=</span> <span class="op">~</span> <span class="fl">10</span> <span class="op">^</span> <span class="op">(</span><span class="op">-</span><span class="va">.</span><span class="op">)</span>,</span>
<span>                                             breaks <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">v_train</span> <span class="op">&lt;-</span> <span class="va">v_train</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggrepel.slowkow.com/reference/geom_text_repel.html" class="external-link">geom_label_repel</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">logFC</span>, y <span class="op">=</span> <span class="va">log10_pval</span>,</span>
<span>                         label <span class="op">=</span> <span class="va">feature_label</span><span class="op">)</span>,</span>
<span>                     data <span class="op">=</span> <span class="va">train_labels</span>,</span>
<span>                     force <span class="op">=</span> <span class="fl">0</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="op">(</span><span class="va">ome</span> <span class="op">==</span> <span class="st">"METAB"</span><span class="op">)</span>,</span>
<span>                     direction <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>                     size <span class="op">=</span> <span class="fl">5</span> <span class="op">/</span> <span class="va">.pt</span>, <span class="co"># (5 - 0.7 * (ome == "METAB")) / .pt,</span></span>
<span>                     fill <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html" class="external-link">alpha</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="fl">0.65</span><span class="op">)</span>,</span>
<span>                     label.padding <span class="op">=</span> <span class="fl">0.10</span>,</span>
<span>                     label.size <span class="op">=</span> <span class="fl">0.16</span>,</span>
<span>                     segment.size <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>                     box.padding <span class="op">=</span> <span class="fl">0.13</span>,</span>
<span>                     min.segment.length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0</span>, <span class="st">"pt"</span><span class="op">)</span>,</span>
<span>                     nudge_x <span class="op">=</span> <span class="va">train_labels</span><span class="op">$</span><span class="va">nudge_x</span>,</span>
<span>                     nudge_y <span class="op">=</span> <span class="va">train_labels</span><span class="op">$</span><span class="va">nudge_y</span> <span class="op">+</span></span>
<span>                       <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">ome</span> <span class="op">==</span> <span class="st">"TRNSCRPT"</span> <span class="op">~</span> <span class="fl">0.6</span>, <span class="co"># 0.4</span></span>
<span>                                 <span class="va">ome</span> <span class="op">==</span> <span class="st">"PHOSPHO"</span> <span class="op">~</span> <span class="fl">0.6</span>, <span class="co"># 0.4</span></span>
<span>                                 <span class="va">ome</span> <span class="op">==</span> <span class="st">"PROT"</span> <span class="op">~</span> <span class="fl">0.6</span>, <span class="co"># 0.5</span></span>
<span>                                 <span class="va">ome</span> <span class="op">==</span> <span class="st">"METAB"</span> <span class="op">~</span> <span class="fl">0.8</span><span class="op">)</span>, <span class="co"># 0.6</span></span>
<span>                     seed <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                     max.overlaps <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.grid.major <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">v_train</span> <span class="co"># display plot</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">".."</span>, <span class="st">".."</span>, <span class="st">"plots"</span>, </span>
<span>                   <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"volcano_%s_trained_vs_SED.pdf"</span>, <span class="va">ome</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         <span class="va">v_train</span>, height <span class="op">=</span> <span class="fl">55</span>, width <span class="op">=</span> <span class="fl">180</span>, units <span class="op">=</span> <span class="st">"mm"</span>, family <span class="op">=</span> <span class="st">"ArialMT"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="section level2">
<h2 id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.3.3 (2024-02-29)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 22.04.4 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt;  [1] scales_1.3.0                       ggrepel_0.9.5                     </span></span>
<span><span class="co">#&gt;  [3] ggplot2_3.5.0                      latex2exp_0.9.6                   </span></span>
<span><span class="co">#&gt;  [5] purrr_1.0.2                        tibble_3.2.1                      </span></span>
<span><span class="co">#&gt;  [7] tidyr_1.3.1                        dplyr_1.1.4                       </span></span>
<span><span class="co">#&gt;  [9] MotrpacRatTraining6moWAT_1.0.0     Biobase_2.62.0                    </span></span>
<span><span class="co">#&gt; [11] BiocGenerics_0.48.1                MotrpacRatTraining6moWATData_2.0.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;   [1] RColorBrewer_1.1-3      rstudioapi_0.15.0       jsonlite_1.8.8         </span></span>
<span><span class="co">#&gt;   [4] shape_1.4.6.1           magrittr_2.0.3          ggbeeswarm_0.7.2       </span></span>
<span><span class="co">#&gt;   [7] rmarkdown_2.25          GlobalOptions_0.1.2     fs_1.6.3               </span></span>
<span><span class="co">#&gt;  [10] zlibbioc_1.48.0         ragg_1.2.7              vctrs_0.6.5            </span></span>
<span><span class="co">#&gt;  [13] memoise_2.0.1           RCurl_1.98-1.14         base64enc_0.1-3        </span></span>
<span><span class="co">#&gt;  [16] rstatix_0.7.2           htmltools_0.5.7         dynamicTreeCut_1.63-1  </span></span>
<span><span class="co">#&gt;  [19] curl_5.2.1              broom_1.0.5             Formula_1.2-5          </span></span>
<span><span class="co">#&gt;  [22] sass_0.4.8              bslib_0.6.1             htmlwidgets_1.6.4      </span></span>
<span><span class="co">#&gt;  [25] desc_1.4.3              impute_1.76.0           cachem_1.0.8           </span></span>
<span><span class="co">#&gt;  [28] lifecycle_1.0.4         iterators_1.0.14        pkgconfig_2.0.3        </span></span>
<span><span class="co">#&gt;  [31] Matrix_1.6-5            R6_2.5.1                fastmap_1.1.1          </span></span>
<span><span class="co">#&gt;  [34] GenomeInfoDbData_1.2.11 clue_0.3-65             digest_0.6.34          </span></span>
<span><span class="co">#&gt;  [37] colorspace_2.1-0        patchwork_1.2.0         AnnotationDbi_1.64.1   </span></span>
<span><span class="co">#&gt;  [40] S4Vectors_0.40.2        textshaping_0.3.7       Hmisc_5.1-1            </span></span>
<span><span class="co">#&gt;  [43] RSQLite_2.3.5           ggpubr_0.6.0            filelock_1.0.3         </span></span>
<span><span class="co">#&gt;  [46] fansi_1.0.6             httr_1.4.7              abind_1.4-5            </span></span>
<span><span class="co">#&gt;  [49] compiler_4.3.3          withr_3.0.0             bit64_4.0.5            </span></span>
<span><span class="co">#&gt;  [52] doParallel_1.0.17       htmlTable_2.4.2         backports_1.4.1        </span></span>
<span><span class="co">#&gt;  [55] BiocParallel_1.36.0     carData_3.0-5           DBI_1.2.2              </span></span>
<span><span class="co">#&gt;  [58] ggsignif_0.6.4          rjson_0.2.21            tools_4.3.3            </span></span>
<span><span class="co">#&gt;  [61] vipor_0.4.7             foreign_0.8-86          beeswarm_0.4.0         </span></span>
<span><span class="co">#&gt;  [64] msigdbr_7.5.1           nnet_7.3-19             glue_1.7.0             </span></span>
<span><span class="co">#&gt;  [67] grid_4.3.3              checkmate_2.3.1         cluster_2.1.6          </span></span>
<span><span class="co">#&gt;  [70] fgsea_1.28.0            generics_0.1.3          gtable_0.3.4           </span></span>
<span><span class="co">#&gt;  [73] preprocessCore_1.64.0   data.table_1.15.2       WGCNA_1.72-5           </span></span>
<span><span class="co">#&gt;  [76] car_3.1-2               utf8_1.2.4              XVector_0.42.0         </span></span>
<span><span class="co">#&gt;  [79] foreach_1.5.2           pillar_1.9.0            stringr_1.5.1          </span></span>
<span><span class="co">#&gt;  [82] babelgene_22.9          limma_3.58.1            circlize_0.4.16        </span></span>
<span><span class="co">#&gt;  [85] splines_4.3.3           BiocFileCache_2.10.1    lattice_0.22-5         </span></span>
<span><span class="co">#&gt;  [88] survival_3.5-8          bit_4.0.5               tidyselect_1.2.0       </span></span>
<span><span class="co">#&gt;  [91] GO.db_3.18.0            ComplexHeatmap_2.18.0   locfit_1.5-9.9         </span></span>
<span><span class="co">#&gt;  [94] Biostrings_2.70.2       knitr_1.45              gridExtra_2.3          </span></span>
<span><span class="co">#&gt;  [97] IRanges_2.36.0          edgeR_4.0.16            stats4_4.3.3           </span></span>
<span><span class="co">#&gt; [100] xfun_0.42               statmod_1.5.0           matrixStats_1.2.0      </span></span>
<span><span class="co">#&gt; [103] stringi_1.8.3           yaml_2.3.8              evaluate_0.23          </span></span>
<span><span class="co">#&gt; [106] codetools_0.2-19        cli_3.6.2               ontologyIndex_2.12     </span></span>
<span><span class="co">#&gt; [109] rpart_4.1.23            systemfonts_1.0.5       munsell_0.5.0          </span></span>
<span><span class="co">#&gt; [112] jquerylib_0.1.4         Rcpp_1.0.12             GenomeInfoDb_1.38.6    </span></span>
<span><span class="co">#&gt; [115] dbplyr_2.4.0            png_0.1-8               fastcluster_1.2.6      </span></span>
<span><span class="co">#&gt; [118] parallel_4.3.3          pkgdown_2.0.7           blob_1.2.4             </span></span>
<span><span class="co">#&gt; [121] bitops_1.0-7            crayon_1.5.2            GetoptLong_1.0.5       </span></span>
<span><span class="co">#&gt; [124] rlang_1.1.3             cowplot_1.1.3           fastmatch_1.1-4        </span></span>
<span><span class="co">#&gt; [127] KEGGREST_1.42.0</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Tyler J. Sagendorf, Zhenxin Hou.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
